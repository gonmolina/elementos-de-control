

<!DOCTYPE html>


<html lang="es" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Sistema masa resorte amortiguador &#8212; Dise침o de Sistemas de Control</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "gonmolina/material_ceaten");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "游눫 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="../../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/modulo1/ejemplos_sistemas/resorte_no_lineal';</script>
    <link rel="canonical" href="https://gonmolina.github.io/git material_ceaten/contents/modulo1/ejemplos_sistemas/resorte_no_lineal.html" />
    <link rel="index" title="칈ndice" href="../../../genindex.html" />
    <link rel="search" title="B칰squeda" href="../../../search.html" />
    <link rel="next" title="Ecuaciones de Cin칠tica Puntual" href="CineticaPuntual.html" />
    <link rel="prev" title="Ejemplos de modelos de sistemas" href="ejemplos_sistemas.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Saltar al contenido principal</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../ceaten_sources/intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/sala_de_control.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../../_static/sala_de_control.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../ceaten_sources/intro.html">
                    Material de la materia Elementos de Control de CEATEN
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Instalaci칩n de Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../guia_instalacion/guia_de_instalacion.html">Gu칤a de instalaci칩n de las herramientas computacionales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_python/Introducci%C3%B3n%20a%20los%20notebooks%20de%20Jupyter.html">Introducci칩n a los cuadernos de Jupyter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Se침ales, sistemas y modelos</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro_sys_sen/intro_sis_y_sen.html">Definiciones de Sistemas y Se침ales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../laplace/transformada_laplace_python_opcional.html">Transformada de Laplace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../laplace/funcion_transferencia.html">Funci칩n transferencia</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="ejemplos_sistemas.html">Ejemplos de modelos de sistemas</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Sistema masa resorte amortiguador</a></li>
<li class="toctree-l2"><a class="reference internal" href="CineticaPuntual.html">Ecuaciones de Cin칠tica Puntual</a></li>
<li class="toctree-l2"><a class="reference internal" href="Ejemplo_Presa_Depredador.html">Sistema presa depredador (Lotka-Volterra)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">An치lisis de la respuesta temporal</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../modulo2/estabilidad/estabilidad.html">Estabilidad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modulo2/respuesta%20temporal/Respuesta%20Temporal.html">Respuesta temporal de sistemas din치micos</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">An치lisis de estado estacionario</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../modulo3/realimentacion/carateristicas%20de%20la%20realimentacion.html">Caracter칤sticas de la realimentaci칩n</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modulo3/errores/Errores.html">Errores</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lugar de las ra칤ces</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../modulo4/lugar%20de%20las%20raices.html">Lugar de las ra칤ces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modulo4/Pasos%20para%20el%20trazado.html">Pasos para trazar el lugar geom칠trico de las ra칤ces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modulo4/Lugar%20de%20la%20raices%20con%20Python.html">Lugar de las ra칤ces usando Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Anexo 1: Introducci칩n a Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../intro_python/Extra_Python.html">Introducci칩n a Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_python/Intro-Matplotlib.html">Figuras en Python - MATPLOTLIB</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/gonmolina/material_ceaten.git" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Repositorio de origen"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gonmolina/material_ceaten.git/edit/main/src/contents/modulo1/ejemplos_sistemas/resorte_no_lineal.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gonmolina/material_ceaten.git/issues/new?title=Issue%20on%20page%20%2Fcontents/modulo1/ejemplos_sistemas/resorte_no_lineal.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Abrir un problema"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/contents/modulo1/ejemplos_sistemas/resorte_no_lineal.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="claro/oscuro" aria-label="claro/oscuro" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="B칰squeda" aria-label="B칰squeda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sistema masa resorte amortiguador</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ecuaciones-de-movimiento">Ecuaciones de movimiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-en-python">Implementaci칩n del modelo en Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verificacion-de-la-no-linealidad">Verificaci칩n de la no linealidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sistema-linealizado">Sistema linealizado</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sistema-masa-resorte-amortiguador">
<h1>Sistema masa resorte amortiguador<a class="headerlink" href="#sistema-masa-resorte-amortiguador" title="Permalink to this heading">#</a></h1>
<section id="ecuaciones-de-movimiento">
<h2>Ecuaciones de movimiento<a class="headerlink" href="#ecuaciones-de-movimiento" title="Permalink to this heading">#</a></h2>
<p>Supongamos que el resorte no cumple la ley de Hook, sino que produce una fuerza que es:</p>
<div class="math notranslate nohighlight">
\[f_k = Kx^3\]</div>
<p>Entonces las ecuaciones de movimiento son</p>
<div class="math notranslate nohighlight">
\[ ma(t) = F+mg - f_b - f_k \implies m \ddot x(t) = F + mg - b \dot x(t) - K x^3(t)\]</div>
<p>Podemos escribir las ecuaciones de estado, suponiendo los estados son <span class="math notranslate nohighlight">\(\dot x = x_1\)</span> y <span class="math notranslate nohighlight">\(x = x_2\)</span>. Entonces resultan:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \left\{
    \begin{array}{ll}
      \dot x_1(t) =  &amp; -\dfrac{b}{m} x_1(t) - \dfrac{K} {m} x_2^3(t) +\dfrac{F(t)}{m} + g\\
      \dot x_2(t) =  &amp; x_1(t)
    \end{array}
  \right.
\end{split}\]</div>
</section>
<section id="implementacion-del-modelo-en-python">
<h2>Implementaci칩n del modelo en Python<a class="headerlink" href="#implementacion-del-modelo-en-python" title="Permalink to this heading">#</a></h2>
<p>Este ejemplo implementaremos utilizando un funci칩n que no permite modelos sistemas din치micos escritos como ecuaciones de estado. Para esto importaremos algunos 춺paquetes췉 para Python.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">control</span> <span class="k">as</span> <span class="nn">ctrl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># descomentar la siguiente linea para ver la imagen e una ventana emergente</span>
<span class="c1"># %matplotlib qt5</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">resorte_derivs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{}):</span>
    <span class="c1"># Ajuste de los par치metros del modelo b=1, m=3, K=2, g=9.8</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="mf">3.</span><span class="p">)</span>                 <span class="c1"># mass</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>                 <span class="c1"># gravitational constant, m/s^2</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>                  <span class="c1"># coefficient of rolling friction</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="mf">9.8</span><span class="p">)</span>                <span class="c1"># drag coefficient</span>
    
    <span class="n">dx</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">dx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">K</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">m</span><span class="o">+</span><span class="n">g</span>
    <span class="n">dx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">dx</span>   

<span class="k">def</span> <span class="nf">resorte_salidas</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{}):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>A partir de las funciones anteriores (ecuaciones de estado), podemos definir el modelo del sistema en Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resorte_nl</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">NonlinearIOSystem</span><span class="p">(</span><span class="n">resorte_derivs</span><span class="p">,</span> <span class="n">resorte_salidas</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;resorte&#39;</span><span class="p">,</span>
                                    <span class="n">inputs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">),</span> <span class="n">outputs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">),</span> <span class="n">state</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;vel&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Para poder simular el sistema nos queda definir:</p>
<ul class="simple">
<li><p>en que tiempos queremos tener la respuesta del sistema</p></li>
<li><p>cuanto vale la entrada para los tiempos definidos anteriormente</p></li>
</ul>
<p>Para esto vamos a suponer que queremos las salidas cada 0.01 segundos, entre 0 y 10 segundos.</p>
<p>La salida vamos a tomar un escal칩n unitario en <span class="math notranslate nohighlight">\(t=1\)</span>, es decir que <span class="math notranslate nohighlight">\(F=0\)</span> para <span class="math notranslate nohighlight">\(t\leq 1\)</span> y <span class="math notranslate nohighlight">\(F=1\)</span> para <span class="math notranslate nohighlight">\(t&gt;1\)</span>.</p>
<p>Estas dos condiciones la definimos en la siguiente celda.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">40</span><span class="p">:</span>
        <span class="n">u</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">u</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Analicemos la se침al que acabamos de crear. Para esto vamos a ver los valores que toma <span class="math notranslate nohighlight">\(u\)</span> en funci칩n del tiempo <span class="math notranslate nohighlight">\(t\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Escal칩n unitario en $t=1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor de $u$&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ce765ded3ca0361f83a422542a265f1e0a88883718bdd1c3e5e3b7caa388ffb0.png" src="../../../_images/ce765ded3ca0361f83a422542a265f1e0a88883718bdd1c3e5e3b7caa388ffb0.png" />
</div>
</div>
<p>Podemos ver que la se침al que creamos es efectivamente lo que quer칤amos. Una se침al que vale 0 para tiempos menores que 1 y 1 para tiempos mayores a 1.</p>
<p>Ahora tenemos todo lo necesario para simular el sistema din치mico. Para esto usaremos otra funci칩n del paquete de control.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">input_output_response</span><span class="p">(</span><span class="n">resorte_nl</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">resp</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Respuesta del sistema a un escal칩n unitario&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor de la pos&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/d4cf9a3760d5539f7314a67fb0d14d02847986b2befd63ba00e6340d8b4a6e70.png" src="../../../_images/d4cf9a3760d5539f7314a67fb0d14d02847986b2befd63ba00e6340d8b4a6e70.png" />
</div>
</div>
<p>Analicemos ahora que sucede en esta figura.</p>
<p>La posici칩n de la masa es 0. O sea consideramos que el resorte esta en una posici칩n de re reposo. Sin embargo,la masa tiene aplicada la fuerza de gravedad. Arrancar la simulaci칩n ser칤a como soltar la masa desde la posici칩n de reposo del resorte.</p>
<p>Cuando se suelte la masa cae y empieza a oscilar. Luego de un tiempo se estabiliza en torno a una posici칩n que llamaremos de equilibrio. En esta posici칩n, si no cambia la fuerza aplicada a la masa esta se quedar칤a quieta.</p>
<p>En t=40, cuando entra la fuerza, comienza nuevamente la evoluci칩n din치mica del sistema.</p>
<p>Muchas veces se estudia al sistema desde el punto de equilibrio, es decir cuando est치 quieto. Para esto debemos obtener en que punto del espacio de estados el sistema se queda quieto. Mirando la figura anterior podemos notar que si no entrara la fuerza en <span class="math notranslate nohighlight">\(t=40\)</span> el sistema se estabilizar칤a en torno a una posici칩n cercana a 2.5. En esa posici칩n, para <span class="math notranslate nohighlight">\(u=0\)</span>, <em>el sistema se queda quieto</em>. Matem치ticamente, que el sistema se quede quieto significa que todas las derivadas de las variables de estado son igual 0.</p>
<p>Entonces, podr칤amos calcular de forma exacta este punto evaluando para <code class="docutils literal notranslate"><span class="pre">x</span></code> se hace 0 la funci칩n <code class="docutils literal notranslate"><span class="pre">resorte_derivs</span></code>. El calculo de este punto queda fuera del alcance del curso.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="n">x0</span><span class="o">=</span><span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">resorte_derivs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">,[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">resorte_derivs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x0</span><span class="p">,[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.71056941e-48 2.44965982e+00] [0.00000000e+00 1.71056941e-48]
</pre></div>
</div>
</div>
</details>
</div>
<p>Ahora el punto de equilibrio fue calculado y se encuentra guardado en la variable <code class="docutils literal notranslate"><span class="pre">x0</span></code>, repitamos la simulaci칩n anterior, pero comenzando la simulaci칩n en este punto de equilibrio.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp_eq</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">input_output_response</span><span class="p">(</span><span class="n">resorte_nl</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">X0</span><span class="o">=</span><span class="n">x0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resp_eq</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">resp_eq</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Respuesta del sistema a un escal칩n unitario&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor de la pos&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e2c84ff4706359d112fe3b7499812d7e273e23f92240b53440b46a681e78c730.png" src="../../../_images/e2c84ff4706359d112fe3b7499812d7e273e23f92240b53440b46a681e78c730.png" />
</div>
</div>
</section>
<section id="verificacion-de-la-no-linealidad">
<h2>Verificaci칩n de la no linealidad<a class="headerlink" href="#verificacion-de-la-no-linealidad" title="Permalink to this heading">#</a></h2>
<p>Para verificar la no linealidad debemos mostrar que no se verifica superposici칩n. Una forma simple de verificar superposici칩n es simular el sistema frente a dos entradas, de forma que la segunda entrada sea el doble de la primera. Si el sistema es lineal, <strong>la salida de la segunda simulaci칩n deber치 presentar una desviaci칩n respecto al punto de equilibrio del doble de primera</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp1</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">input_output_response</span><span class="p">(</span><span class="n">resorte_nl</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">X0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>
<span class="n">resp2</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">input_output_response</span><span class="p">(</span><span class="n">resorte_nl</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">X0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resp1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">resp1</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;salida 1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resp2</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">resp2</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;salida 2&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Respuesta del sistema a un escal칩n unitario&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor de la pos&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/78e73fbed37daf51431be594f136b92ad098287f9f900bc5871913b93f82ddae.png" src="../../../_images/78e73fbed37daf51431be594f136b92ad098287f9f900bc5871913b93f82ddae.png" />
</div>
</div>
<p>Vemos que la primer salida el valor final es aproximadamente 2.7 y para la segunda es 2.91. El valor inicial de ambas es 2.45. Por lo tanto tenemos que:</p>
<div class="math notranslate nohighlight">
\[2.7-2.45=0.25\]</div>
<div class="math notranslate nohighlight">
\[2.91-2.45=0.46\]</div>
<p>Vemos que la desviaci칩n de la  salida no es exactamente el doble. Pero esta bastante cerca de serlo.</p>
<p>Hagamos una tercera verificaci칩n, pero ahora hagamos la entrada 5 veces m치s grande.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp3</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">input_output_response</span><span class="p">(</span><span class="n">resorte_nl</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">X0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resp1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">resp1</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;salida 1&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resp3</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">resp3</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;salida 3&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Respuesta del sistema a un escal칩n unitario&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor de la pos&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/2396fd605d26d22498acbcda01579044bcc951d40383171553ab1e86a024f90c.png" src="../../../_images/2396fd605d26d22498acbcda01579044bcc951d40383171553ab1e86a024f90c.png" />
</div>
</div>
<p>Para esta tercer simulaci칩n el valor final es:</p>
<div class="math notranslate nohighlight">
\[3.41-2.46 = 0.95\]</div>
<p>Si el sistema fuese lineal la salida deber칤a esperada es 5 veces la diferencia de la primer simulaci칩n:</p>
<div class="math notranslate nohighlight">
\[5\times 0.25 = 1.25\]</div>
<p>Ahora podemos notar de forma m치s clara la presencia de la no linealidad.</p>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>En general la presencia de la no linealidad se hace m치s notoria cuando las desviaciones desde el punto de equilibrio son m치s grandes.</p>
</div>
</section>
<section id="sistema-linealizado">
<h2>Sistema linealizado<a class="headerlink" href="#sistema-linealizado" title="Permalink to this heading">#</a></h2>
<p>Generalmente los sistemas no lineales son dif칤ciles de estudiar, analizar y sacar conclusiones. Por lo que en el area de control de sistemas din치micos, <strong>en general se trabaja con sistemas linealizados en torno al puno de equilibrio</strong>. La linealizaci칩n de un sistema no lineal escapa al alcance de este curso, pero se muestra una forma de hacerla en la celda oculta debajo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resorte_l</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">linearize</span><span class="p">(</span><span class="n">resorte_nl</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Los sistemas lineales son m치s f치ciles de simular y el paquete de control que utilizaremos posee herramientas para hacer simulaciones frente a la se침ales m치s comunes como son el escal칩n y el impulso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">step_response</span><span class="p">(</span><span class="n">resorte_l</span><span class="p">)</span>
<span class="n">ir</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">(</span><span class="n">resorte_l</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sr</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Respuesta al escal칩n&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ir</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">ir</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Respuesta al impulso&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Respuestas del sistema lineal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Desv de la pos&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/1415cccf0f6f24509e294313f9d95930bbb2dff2d097684cb7a17a40c81c4062.png" src="../../../_images/1415cccf0f6f24509e294313f9d95930bbb2dff2d097684cb7a17a40c81c4062.png" />
</div>
</div>
<p>Para simular el sistema frente a entradas arbitrarias, tambi칠n tenemos una funci칩n util para sistemas lineales:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fr</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">forced_response</span><span class="p">(</span><span class="n">resorte_l</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fr</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">fr</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Respuesta del sistema a un escal칩n unitario&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor de la desv. de la pos&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/68fd0873c0dd99b68f76dbff6ce1841c47a6d51b8240dd5e16f85efafbdb2da8.png" src="../../../_images/68fd0873c0dd99b68f76dbff6ce1841c47a6d51b8240dd5e16f85efafbdb2da8.png" />
</div>
</div>
<p>Podemos ver que la evoluci칩n luce similar a la de la simulaci칩n no lineal. Sin embargo, cuando miramos el eje <span class="math notranslate nohighlight">\(y\)</span> vemos que tiene valores diferentes. Esto es porque la evoluci칩n es la desviaci칩n respecto del punto de equilibrio.</p>
<p>Para que ambas simulaciones sean comparables debemos sumar la valor de la salida de la simulaci칩n lineal, el valor de la salida en el punto de equilibrio.</p>
<p>Haciendo esto y superponiendo con la simulaci칩n no lineal tenemos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fr</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">fr</span><span class="o">.</span><span class="n">outputs</span><span class="o">+</span><span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">resp_eq</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">resp_eq</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Respuesta del sistema a un escal칩n unitario&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo [s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor de la desv. de la pos&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/5d886db823df530309ccade7e6a8fe386baf886d9aa04ee76a4f320124afd7e8.png" src="../../../_images/5d886db823df530309ccade7e6a8fe386baf886d9aa04ee76a4f320124afd7e8.png" />
</div>
</div>
<p>Vemos que las evoluciones son parecidas, aunque no iguales. A medida que se aumente el valor del escal칩n, el sistema se alejar치 m치s del punto de equilibrio y las diferencias ser치n cada vez m치s notorias.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contents/modulo1/ejemplos_sistemas"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="ejemplos_sistemas.html"
       title="p치gina anterior">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">anterior</p>
        <p class="prev-next-title">Ejemplos de modelos de sistemas</p>
      </div>
    </a>
    <a class="right-next"
       href="CineticaPuntual.html"
       title="siguiente p치gina">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title">Ecuaciones de Cin칠tica Puntual</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ecuaciones-de-movimiento">Ecuaciones de movimiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-en-python">Implementaci칩n del modelo en Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verificacion-de-la-no-linealidad">Verificaci칩n de la no linealidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sistema-linealizado">Sistema linealizado</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Dr. Ing. Gonzalo Molina; Ing. Juan Pablo Pierini
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      춸 Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>